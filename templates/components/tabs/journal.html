<div x-show="currentTab === 'journal'" class="max-w-4xl mx-auto space-y-8 animate-scale-in">
    <div class="flex justify-between items-end">
        <div>
            <h2 class="text-3xl font-bold">Daily Journal</h2>
            <p class="text-white/40 text-sm mt-1">Reflect, record, and grow.</p>
        </div>
        <!-- Mood Selector -->
        <div class="flex gap-2 bg-white/5 p-2 rounded-full border border-white/10">
            <template x-for="mood in ['ðŸ˜¢', 'ðŸ˜', 'ðŸ™‚', 'ðŸ˜€', 'ðŸ¤©']">
                <button @click="setMood(mood)"
                        class="w-10 h-10 rounded-full flex items-center justify-center text-xl transition hover:scale-110"
                        :class="currentMood === mood ? 'bg-purple-600 shadow-lg scale-110' : 'hover:bg-white/10 opacity-50 hover:opacity-100'"
                        x-text="mood">
                </button>
            </template>
        </div>
    </div>

     <!-- Calendar -->
     <div class="glass-panel p-4 rounded-[24px] flex gap-3 overflow-x-auto custom-scroll snap-x">
        <template x-for="day in calendarDays">
            <button @click="selectDate(day)"
                    class="flex-shrink-0 w-16 h-20 rounded-2xl flex flex-col items-center justify-center gap-1 transition-all duration-300 snap-center border"
                    :class="day.active ? 'bg-purple-600 border-purple-500 text-white shadow-lg shadow-purple-900/40 transform scale-105' : 'bg-white/5 border-transparent text-white/40 hover:bg-white/10 hover:text-white'">
                <span class="text-xs font-bold uppercase tracking-wider" x-text="day.day"></span>
                <span class="text-xl font-bold" x-text="day.date"></span>
                <div class="w-1 h-1 rounded-full bg-white/50 mt-1" x-show="journalEntries[day.fullDate]"></div>
            </button>
        </template>
    </div>

    <!-- Daily Prompt Banner -->
    <div x-show="promptVisible" class="bg-gradient-to-r from-purple-900/40 to-blue-900/40 border border-purple-500/30 p-4 rounded-2xl flex justify-between items-center animate-fade-in-up">
        <div class="flex items-center gap-3">
            <span class="text-2xl">ðŸ’¡</span>
            <div>
                <p class="text-xs text-purple-300 font-bold uppercase tracking-wider">Thought Starter</p>
                <p class="text-white font-medium italic" x-text="currentPrompt"></p>
            </div>
        </div>
        <button @click="dismissPrompt" class="p-2 hover:bg-white/10 rounded-full text-white/50 hover:text-white">âœ•</button>
    </div>

    <div class="glass-card p-8 rounded-[32px]">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold" x-text="new Date(selectedDate).toLocaleDateString(undefined, {weekday:'long', month:'long', day:'numeric'})"></h3>
            <div class="flex gap-3">
                <button @click="getNewPrompt" class="px-4 py-2 rounded-full bg-white/5 hover:bg-white/10 text-white/70 hover:text-white text-xs font-bold transition border border-white/5">ðŸ’¡ Prompt</button>
                <button @click="toggleSpeech"
                        class="px-4 py-2 rounded-full font-bold text-xs transition border border-white/5 flex items-center gap-2"
                        :class="isListening ? 'bg-red-500/20 text-red-400 border-red-500/50 animate-pulse' : 'bg-white/5 text-white/70 hover:bg-white/10 hover:text-white'">
                   <span x-text="isListening ? 'ðŸŽ™ï¸ Listening...' : 'ðŸŽ™ï¸ Dictate'"></span>
                </button>
            </div>
        </div>

        <textarea x-model="journalInput"
                  class="w-full h-64 bg-black/20 border border-white/10 rounded-2xl p-6 text-white text-lg leading-relaxed focus:outline-none focus:border-purple-500 transition-all resize-none placeholder-white/20"
                  placeholder="How are you feeling today? What's on your mind?"></textarea>

        <!-- Gratitude Section -->
        <div class="mt-8">
            <h4 class="text-sm font-bold text-white/60 uppercase tracking-widest mb-4">I am grateful for...</h4>
            <div class="space-y-3">
                <template x-for="(g, index) in gratitudeInputs">
                    <div class="flex items-center gap-3">
                        <span class="text-white/30 font-bold text-sm" x-text="index + 1 + '.'"></span>
                        <input type="text" x-model="gratitudeInputs[index]"
                               class="w-full bg-white/5 border border-white/5 rounded-xl px-4 py-2 text-white placeholder-white/20 focus:outline-none focus:border-purple-500/50 transition"
                               placeholder="Enter something you are grateful for...">
                    </div>
                </template>
            </div>
        </div>

        <div class="flex justify-end gap-3 mt-8 pt-6 border-t border-white/5">
            <button @click="analyzeJournal" class="px-6 py-2 rounded-full bg-white/10 hover:bg-white/20 text-white font-bold text-sm transition border border-white/10 flex items-center gap-2"><span>âœ¨</span> Analyze</button>
            <button @click="saveJournal" class="px-6 py-2 rounded-full bg-purple-600 hover:bg-purple-500 text-white font-bold text-sm transition shadow-lg shadow-purple-900/20">Save Entry</button>
        </div>

        <div x-show="journalAnalysis && journalAnalysis[selectedDate]" class="mt-8 p-6 rounded-2xl bg-white/5 border border-white/5 animate-scale-in">
            <h4 class="text-xs font-bold text-purple-400 uppercase tracking-widest mb-4 flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-purple-500 animate-pulse"></span> AI Analysis</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <div class="text-white/40 text-xs uppercase tracking-widest mb-1">Detected Mood</div>
                    <div class="text-lg font-bold" x-text="journalAnalysis[selectedDate]?.mood"></div>
                </div>
                <div>
                    <div class="text-white/40 text-xs uppercase tracking-widest mb-1">Triggers</div>
                    <div class="flex flex-wrap gap-2">
                        <template x-for="trig in journalAnalysis[selectedDate]?.triggers">
                            <span class="px-2 py-1 rounded bg-white/10 text-xs" x-text="trig"></span>
                        </template>
                    </div>
                </div>
                <div class="md:col-span-2">
                    <div class="text-white/40 text-xs uppercase tracking-widest mb-1">Recommendation</div>
                    <p class="text-white/80 leading-relaxed" x-text="journalAnalysis[selectedDate]?.tip"></p>
                </div>
            </div>
        </div>
    </div>
</div>